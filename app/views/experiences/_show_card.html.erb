<div class="show-container" id="page" style = height:fit-content;>
  <h2 class="title"><%= @experience.title.capitalize  %></h2>
  <%# icon with text Bertha likes this date idea%>
  <div class="d-flex justify-content-between" style="margin-left: 20px;">
    <div class= "d-flex">
      <i class="fa-solid fa-location-dot"> </i>
      <h6><%= @experience.address.capitalize %></h6>
    </div>
    <div class="d-flex favs">
      <% if user_signed_in? %>
        <%= turbo_frame_tag dom_id(@experience, :favorite) do %>
          <% if @experience.favorited_by?(current_user) %>
            <%= link_to  unfavorite_experience_path(@experience), data: { turbo_method: :patch} do%>
              <%= cl_image_tag current_user.avatar.key,  crop: :fill, class:"avatar-show heart-show"%>
              <%# <img class="avatar-user favor-user" src="https://via.placeholder.com/229x193" %>
            <% end %>
          <% elsif @experience.secret_list.include?(current_user.id.to_s) %>
            <%= link_to unsecret_experience_path(@experience), data: { turbo_method: :patch} do%>
              <i class="fa-solid fa-mask heart-show" id="red-mask"></i>
            <% end %>
          <% else %>
            <%= link_to favorite_experience_path(@experience), data: { turbo_method: :patch } do %>
              <i class="fa-regular fa-heart favor-user red-heart heart-show"></i>
            <% end %>
            <%= link_to secret_experience_path(@experience), data: { turbo_method: :patch } do %>
              <i class="fa-solid fa-mask mask-show" id="gold-mask-show"></i>
            <% end %>
          <% end %>
          <% if current_user.partner %>
            <% if @experience.favorited_by?(current_user.partner) %>
              <%= cl_image_tag current_user.partner.avatar.key,  crop: :fill, class:"avatar-show"%>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    </div>
  </div>
  <div class="d-flex">
    <div class="m-4 w-100 h-100"> <%= render 'experiences/img_carousel'%></div>
      <div class="show-card p-2 m-4 flex-shrink-1">
        <div class="d-flex flex-column mb-3">
          <h6 class="p-2 d-flex justify-content-center">Avaliable Dates</h6>
            <div class="calendar p-2 d-flex justify-content-center">calendar
            </div>
              <div class="p-2 d-flex justify-content-end">
                <div><%=@experience.cost %></div>
              </div>
              <div class="p-2 d-flex justify-content-end">
                <div class="button-calendar">
                  <p style="margin-bottom: 0px;">
                  <%= link_to "Book Now", new_experience_booking_path(@experience), class: "button-white-text"%> </p>
                </div>
              </div>
          </div>
        </div>
      </div>
  <div class="d-flex">
    <div class="info-card m-4 w-100 d-flex align-items-start flex-column">
      <h4>What you'll do</h4>
        <br>
      <h6> <%= @experience.description %> </h6>
      <div class="mood-icons mt-auto"> <%= @experience.mood_list %> </div>
    </div>
    <div class="map-card flex-shrink-1"> <%= render 'experiences/map'%> </div>
  </div>
  <div class="review-container">
    <h6>Reviews</h6>
    <%= turbo_frame_tag dom_id(@experience, :ratings) do %>
     <%= render "experiences/rating_list", ratings: @ratings %>
    <%end%>
    <%= link_to "Load more", experience_path(@experience, page: @next_page), id: dom_id(@experience, :load_ratings), data: {turbo_method: :post} %>
    <div class="p-2 d-flex justify-content-center">
      <% @experience.bookings.each do |booking| %>
        <% if booking.user_completed_booking? && booking.couple == current_user.couple && !booking.rating%>
          <div class="rating-form col-12 col-md-6">
          <h6>Review your date!</h6>
          <br>
          <%= simple_form_for([booking, @rating]) do |f| %>
            <%= f.error_notification %>
            <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>
            <div class="form-inputs">
              <%= f.input :stars, collection: (1..5), placeholder: '1-5 ⭐s'%>
              <%= f.input :comment, placeholder: '...'%>
            </div>
            <div class="form-actions">
              <%= f.button :button, "Submit", class: "btn btn-primary btn-submit" %>
            </div>
          <% end %>
        <% end %>
      <% end %>
      </div>
    </div>
  </div>
</div>
